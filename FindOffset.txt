ScriptName FindOffset
# script to find proper offset value to run Z_byV2
# assume speciment is ON the eucentricity 

## Eucentric Z
##
#Eucentricity 3
ReportStageXYZ 
Z0 = $repVal3

## now find the offset
# for initial offset, get a close value from current setting
ReportUserSetting LowDoseViewDefocus
offset = $repVal1 - ( $repVal1 / 10 )
# 
Loop 10
CallFunction MyFuncs::Z_byV2 $offset
ReportStageXYZ 
Z = $repVal3
diffZ = $Z - $Z0
echo $diffZ
   If  ABS $diffZ < 0.5 
      offset = ROUND $offset 1
      echo >>> Found "offset" is $offset
      echo >>> run "Z_byZ2 $offset" 
      exit
   Else 
      offset = $offset + $diffZ
   Endif 
EndLoop 
