#include <MsgBoxConstants.au3>
; Set the Escape hotkey to terminate the script.
; based on initial code from Wim Hagen [at] MBEL
;; Chen.xu@umassmed.edu 2017-05-27 

HotKeySet("{ESC}", "Terminate");

NextPP ()

Func NextPP()

   While 1
 WinWait("[TITLE:SerialEM PP; CLASS:#32770]")
 If WinExists("[TITLE:SerialEM PP; CLASS:#32770]") Then
ControlClick("Aperture", "", "[CLASS:Button; INSTANCE:22]")
ControlClick("SerialEM PP", "", "[CLASS:Button; INSTANCE:1]")
 EndIf

 ; Avoid high CPU usage.
 Sleep(1000)
   WEnd
EndFunc   ;==>Example
